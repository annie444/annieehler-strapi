---
/**
 * PostMetadata - Display post metadata (author, date, tags, reading time)
 */
import Calendar from "@components/icons/pixel/Calendar.astro";
import Clock from "@components/icons/pixel/Clock.astro";
import type { BlogPostProps } from "@utils/content/blog";
import { formatPublishDate } from "@utils/content/blog";

interface Props {
  post: BlogPostProps;
  class?: string;
}

const { post, class: className = "" } = Astro.props;

const formattedDate = formatPublishDate(post.publishedAt);
const updatedDate = post.updatedAt ? formatPublishDate(post.updatedAt) : null;
---

<div class:list={["post-metadata", className]}>
  <!-- Date and reading time -->
  <div
    class="text-foreground-dim flex flex-wrap items-center gap-x-4 gap-y-1 text-sm"
  >
    <time datetime={post.publishedAt} class="flex items-center gap-1">
      <Calendar class="h-4 w-4" fill="none" stroke="currentColor" />
      {formattedDate}
    </time>

    {
      updatedDate && updatedDate !== formattedDate && (
        <span class="text-foreground-dim">(Updated {updatedDate})</span>
      )
    }

    {
      post.readingTime && (
        <span class="flex items-center gap-1">
          <Clock class="h-4 w-4" fill="none" stroke="currentColor" />
          {post.readingTime} min read
        </span>
      )
    }
  </div>

  <!-- Author (if available) -->
  {
    post.author && (
      <div class="mt-2 flex items-center gap-2 text-sm">
        <span class="text-foreground-dim">By</span>
        <span class="font-medium">
          {post.author.firstName} {post.author.lastName}
        </span>
      </div>
    )
  }

  <!-- Tags -->
  {
    post.tags && post.tags.length > 0 && (
      <div class="mt-3 flex flex-wrap gap-2">
        {post.tags.map((tag) => (
          <a
            href={`/blog?tags=${tag.slug}`}
            class="border-foreground bg-grey-medium hover:bg-grey-dark inline-block border-2 border-solid px-2 py-0.5 text-xs font-medium transition-colors"
          >
            {tag.name}
          </a>
        ))}
      </div>
    )
  }
</div>
