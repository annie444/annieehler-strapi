---
/**
 * BlogPostIcon - Document icon for blog posts in icon grid view
 * Mimics the classic Mac Finder icon view
 */
import Document from "@components/icons/pixel/Document.astro";
import type { BlogPostProps } from "@utils/content/blog";
import { formatPublishDate } from "@utils/content/blog";

interface Props {
  post: BlogPostProps;
  class?: string;
}

const { post, class: className = "" } = Astro.props;

const formattedDate = formatPublishDate(post.publishedAt);

// Truncate title for display under icon
const maxTitleLength = 24;
const displayTitle =
  post.title.length > maxTitleLength
    ? post.title.slice(0, maxTitleLength - 1) + "…"
    : post.title;
---

<a
  href={`/blog/${post.slug}`}
  class:list={[
    "blog-post-icon group flex flex-col items-center p-3 text-center",
    "rounded transition-all duration-150",
    "hover:bg-blue-100 dark:hover:bg-blue-900/40",
    "focus:ring-2 focus:ring-blue-400 focus:outline-none",
    className,
  ]}
>
  <!-- Document icon -->
  <div class="icon-container relative mb-2">
    <Document size={64} class="transition-transform group-hover:scale-105" />

    {
      post.featured && (
        <span class="absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-yellow-400 text-[10px] dark:bg-yellow-500">
          ★
        </span>
      )
    }
  </div>

  <!-- Title -->
  <span
    class="font-chi block w-full max-w-25 text-sm leading-tight font-medium"
    title={post.title}
  >
    {displayTitle}
  </span>

  <!-- Date -->
  <span class="mt-1 text-[10px] text-neutral-500 dark:text-neutral-400">
    {formattedDate}
  </span>

  <!-- Tags (subtle, on hover) -->
  {
    post.tags && post.tags.length > 0 && (
      <div class="mt-1 flex flex-wrap justify-center gap-1 opacity-0 transition-opacity group-hover:opacity-100">
        {post.tags.slice(0, 2).map((tag) => (
          <span class="rounded bg-neutral-200 px-1 py-0.5 text-[9px] dark:bg-neutral-700">
            {tag.name}
          </span>
        ))}
      </div>
    )
  }
</a>

<style>
  .blog-post-icon {
    width: 120px;
  }
</style>
