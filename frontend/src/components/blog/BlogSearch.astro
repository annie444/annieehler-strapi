---
/**
 * BlogSearch - Search input with System 8.0 styling
 * Integrates with Pagefind for static site search
 */
interface Props {
  placeholder?: string;
  class?: string;
}

const { placeholder = "Search posts...", class: className = "" } = Astro.props;
---

<div class:list={["blog-search relative", className]}>
  <input
    type="search"
    id="blog-search-input"
    placeholder={placeholder}
    class="font-chi w-full border-2 border-solid border-neutral-900 bg-neutral-50 px-3 py-2 pr-10 text-sm placeholder:text-neutral-400 focus:ring-2 focus:ring-blue-400 focus:outline-none dark:border-neutral-100 dark:bg-neutral-800 dark:placeholder:text-neutral-500"
  />
  <svg
    class="absolute top-1/2 right-3 h-4 w-4 -translate-y-1/2 text-neutral-400"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
  </svg>
</div>

<script>
  // Simple client-side search for blog posts
  // Note: For production, integrate with Pagefind's API
  document.addEventListener("DOMContentLoaded", () => {
    const searchInput = document.getElementById(
      "blog-search-input",
    ) as HTMLInputElement;
    if (!searchInput) return;

    let debounceTimer: ReturnType<typeof setTimeout>;

    searchInput.addEventListener("input", (e) => {
      clearTimeout(debounceTimer);
      const query = (e.target as HTMLInputElement).value.trim().toLowerCase();

      debounceTimer = setTimeout(() => {
        // Dispatch custom event for parent to handle search
        const event = new CustomEvent("search-posts", {
          detail: { query },
          bubbles: true,
        });
        document.dispatchEvent(event);
      }, 300);
    });
  });
</script>
